"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const express_1 = require("express");
const auth_controller_1 = require("../controllers/implementations/auth.controller");
const auth_repository_1 = require("../repository/implementations/auth.repository");
const otp_repository_1 = require("../repository/implementations/otp.repository");
const auth_services_1 = require("../services/implementation/auth.services");
const authUser_1 = __importDefault(require("../middlewares/authUser"));
const passport_config_1 = __importDefault(require("../config/passport.config"));
const admin_repository_1 = require("../repository/implementations/admin.repository");
const instructorAuth_repository_1 = require("../repository/implementations/instructorAuth.repository");
const course_repository_1 = require("../repository/implementations/course.repository");
const multer_1 = __importDefault(require("../utils/multer"));
const order_repository_1 = require("../repository/implementations/order.repository");
const authRepository = new auth_repository_1.AuthRepository();
const instructorRepository = new instructorAuth_repository_1.InstructorAuth();
const otpRepository = new otp_repository_1.OtpRepository();
const adminRepository = new admin_repository_1.AdminRepository();
const courseRepository = new course_repository_1.CourseRepository();
const orderRepository = new order_repository_1.OrderRepository();
const authService = new auth_services_1.AuthService(authRepository, otpRepository, adminRepository, instructorRepository, courseRepository, orderRepository);
const authController = new auth_controller_1.Authcontroller(authService);
const router = (0, express_1.Router)();
router.post("/register", authController.signup.bind(authController));
router.post("/login", authController.signin.bind(authController));
router.post("/verify-otp", authController.verifyOtp.bind(authController));
router.post("/forgotpassword", authController.forgotPassword.bind(authController));
router.post("/reset-verify-otp", authController.verifyForgotOtp.bind(authController));
router.put("/resetpassword", authController.resetPassword.bind(authController));
router.post("/verifygoogle", authController.verifyGoogle.bind(authController));
router.post("/resend-otp", authController.resentOtp.bind(authController));
router.get("/profile", authUser_1.default, authController.getProfile.bind(authController));
router.put("/profile", authUser_1.default, multer_1.default.single("profilePicture"), authController.updateProfile.bind(authController));
router.get("/courses", authController.getCourses.bind(authController));
router.post("/orders", authUser_1.default, authController.buyCourse.bind(authController));
router.post("/orders/verify", authUser_1.default, authController.verifyOrder.bind(authController));
router.get("/courses/:courseId", authUser_1.default, authController.findCourseById.bind(authController));
router.get("/auth/google", passport_config_1.default.authenticate("google", { scope: ["profile", "email"], session: false }));
router.get("/auth/google/callback", passport_config_1.default.authenticate("google", { failureRedirect: "/register", session: false }), authController.googleAuth.bind(authController));
exports.default = router;
